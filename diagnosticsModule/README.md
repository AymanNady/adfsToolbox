# ADFS Environment Diagnostics

## Overview

This module provides cmdlets that can be used to perform various tests on AD FS and WAP servers. The tests can help ensure that the AD FS / WAP service are up and running. Using the cmdlets in the module, you can root cause a service level issue faster.

## Available Cmdlets

1. **Get-AdfsSystemInformation**: The Get-AdfsSystemConfiguration gathers information regarding operating system and hardware
2. **Get-AdfsServerConfiguration**: The Get-ADFSServerConfiguration takes a snapshot of the AD FS farm configuration and relevant dependencies
3.  **Test-AdfsServerToken**: It helps to verify if you can reach AD FS service and get a token issued for the credentials supplied or the identity under which the cmdlet is run.
4.  **Test-AdfsServerHealth**: The health checks generated by the Test-AdfsServerHealth cmdlet return a list of results after running a series of tests depending on the version and role of the server.

## Get-AdfsSystemInformation

**No parameters**
**Usage**: <code>Get-AdfsSystemInformation</code>

## Get-AdfsServerConfiguration
* **IncludeTrusts**: Boolean switch to indicate whether trusts (claims provider and relying party) configuration is also to be retrieved<br>
**Usage**: </code>$res = Get-AdfsServerConfiguration â€“ IncludeTrusts</code>

## Test-AdfsServerToken
* **FederationServer**: Federation Server (Farm) host name Federation Server (Farm) host name
* **AppliesTo**: Identifier of the target relying party
* **Credential**: Optional Username Credential used to retrieve the toke<br>
**Usage**: <code>Test-AdfsServerToken -FederationServer sts.contoso.com -AppliesTo urn:examplerpt</code>

## Test-AdfsServerHealth
* verifyO365: Boolean parameter that will enable Office 365 targeted checks. It is true by default
* verifyTrustCerts: Boolean parameter that will enable additional checks for relying party trust and claims provider trust certificates. It is false by default<br>
**Usage**: <code>Test-AdfsServerHealth -VerifyOffice365:<$true / $false> -VerifyTrustCerts:<$true / $false></code>

## Contributing
You are welcome to contribute to the module and provide suggestions. We encourage you to fork this project, include any scripts you 
use for parsing, managing, or manipulating ADFS logs, and then do a pull request to master. If your scripts work, 
we'll include them so everyone can benefit. 

Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the 
right to, and actually do, grant us the rights to use your contribution. For details, visit https://cla.microsoft.com.

When you submit a pull request, a CLA-bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).
For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or
contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.


